{
  "name": "JAX GPU",
  "image": "ghcr.io/nvidia/jax:jax",
  "workspaceFolder": "/workspace",
  "workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind",

  "runArgs": ["--gpus", "all"],

  "postCreateCommand": "python -m pip install --upgrade pip && python -m pip install jupyter ipykernel jaxopt jaxtyping matplotlib && python -m pip install -e . && python -m ipykernel install --user --name devcontainer --display-name 'Python (devcontainer)'",

  "customizations": {
    "vscode": {
      "extensions": ["ms-python.python","ms-toolsai.jupyter"],
      "settings": {
        "extensions.autoUpdate": true
      }
    }
  }
}
